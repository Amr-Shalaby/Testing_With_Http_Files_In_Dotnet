### Create Order - FAILURE Scenarios
### Action: Test validation for Create Order
### Variables loaded from: http-client.env.json

###############################################################################
### STEP 1: Login to Get Token (for authorized failure tests)
###############################################################################

# @name loginForOrderFail
POST {{baseUrl}}{{apiPath}}/auth/login
Content-Type: application/json

{
  "username": "testuser",
  "password": "password123"
}

###

###############################################################################
### FAILURE SCENARIO 1: Create Order Without Authentication
### Expected: 401 Unauthorized
### NOTE: This is now the primary failure - orders require authentication
###############################################################################

POST {{baseUrl}}{{apiPath}}/orders
Content-Type: application/json
Accept: application/json

{
  "orderDate": "2024-10-25T10:30:00Z",
  "items": [
    {
      "productId": 1,
      "quantity": 2,
      "unitPrice": 99.99
    }
  ],
  "shippingAddress": {
    "street": "123 Test St",
    "city": "TestCity",
    "state": "TS",
    "zipCode": "12345",
    "country": "USA"
  }
}

###

###############################################################################
### FAILURE SCENARIO 2: Empty Items Array
### Expected: 400 Bad Request
### NOTE: Use token from login
###############################################################################

POST {{baseUrl}}{{apiPath}}/orders
Authorization: Bearer {{loginForOrderFail.response.body.$.token}}
Content-Type: application/json
Accept: application/json

{
  "orderDate": "2024-10-25T10:30:00Z",
  "items": []
}

###

###############################################################################
### FAILURE SCENARIO 3: Invalid Product ID in Items
### Expected: 400 Bad Request (Product not found)
###############################################################################

POST {{baseUrl}}{{apiPath}}/orders
Authorization: Bearer {{loginForOrderFail.response.body.$.token}}
Content-Type: application/json
Accept: application/json

{
  "orderDate": "2024-10-25T10:30:00Z",
  "items": [
    {
      "productId": 99999,
      "quantity": 1,
      "unitPrice": 99.99
    }
  ],
  "shippingAddress": {
    "street": "123 Test St",
    "city": "TestCity",
    "state": "TS",
    "zipCode": "12345",
    "country": "USA"
  }
}

###

###############################################################################
### FAILURE SCENARIO 4: Negative Quantity
### Expected: Validation error (if implemented)
###############################################################################

POST {{baseUrl}}{{apiPath}}/orders
Authorization: Bearer {{loginForOrderFail.response.body.$.token}}
Content-Type: application/json
Accept: application/json

{
  "orderDate": "2024-10-25T10:30:00Z",
  "items": [
    {
      "productId": 1,
      "quantity": -5,
      "unitPrice": 99.99
    }
  ],
  "shippingAddress": {
    "street": "123 Test St",
    "city": "TestCity",
    "state": "TS",
    "zipCode": "12345",
    "country": "USA"
  }
}

###

###############################################################################
### FAILURE SCENARIO 5: Zero Quantity
### Expected: Validation error (if implemented)
###############################################################################

POST {{baseUrl}}{{apiPath}}/orders
Authorization: Bearer {{loginForOrderFail.response.body.$.token}}
Content-Type: application/json
Accept: application/json

{
  "orderDate": "2024-10-25T10:30:00Z",
  "items": [
    {
      "productId": 1,
      "quantity": 0,
      "unitPrice": 99.99
    }
  ],
  "shippingAddress": {
    "street": "123 Test St",
    "city": "TestCity",
    "state": "TS",
    "zipCode": "12345",
    "country": "USA"
  }
}

###

###############################################################################
### FAILURE SCENARIO 6: Invalid Date Format
### Expected: 400 Bad Request
###############################################################################

POST {{baseUrl}}{{apiPath}}/orders
Authorization: Bearer {{loginForOrderFail.response.body.$.token}}
Content-Type: application/json
Accept: application/json

{
  "orderDate": "invalid-date",
  "items": [
    {
      "productId": 1,
      "quantity": 1,
      "unitPrice": 99.99
    }
  ],
  "shippingAddress": {
    "street": "123 Test St",
    "city": "TestCity",
    "state": "TS",
    "zipCode": "12345",
    "country": "USA"
  }
}

